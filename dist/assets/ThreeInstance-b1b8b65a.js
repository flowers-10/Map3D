var L=Object.defineProperty;var z=(n,t,e)=>t in n?L(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var i=(n,t,e)=>(z(n,typeof t!="symbol"?t+"":t,e),e);import{l as y,D as C,m as A,T as x,n as P,o as O,p as E,q as M,O as T,W as R,S as N,r as B,b as S,s as g,t as H,U as I,G as b,u as D,v as G,H as _,w as F,A as q,x as W,y as X,z as U,I as Y,J as j,K as $}from"./three-003e6fb4.js";import{g as w}from"./gsap-89c74157.js";const Z={el:"_canvas-scene",id:"_scene",type:"CHART",name:"hello world",camera:{fov:60,near:1,far:1e4,position:{x:600,y:600,z:600},lookAt:!0,controls:{show:!0,enableDamping:!0,minPolarAngle:Math.PI*.25,maxPolarAngle:Math.PI*.75,minAzimuthAngle:-Math.PI*.45,maxAzimuthAngle:Math.PI*.25,enablePan:!1}},size:{type:"window",id:"_Background_3D"},rendererPass:{type:"BLOOM",outlineConfig:{edgeStrength:3,edgeGlow:1,edgeThickness:3,pulsePeriod:2,gamma:!0,antiAliasing:!0,showIndex:1},bloomConfig:{strength:.8,radius:.5,threshold:.5}},renderer:{antialias:!0,alpha:!0,clearAlpha:0,clearColor:"#3e3e3e"},light:[{type:"ambient",color:"#ffffff",intensity:.8,helper:!1,lightId:0,lightName:"光源1"}],sources:[]};class f{constructor(){i(this,"callbacks");this.callbacks={},this.callbacks.base={}}on(t,e){return typeof t>"u"||t===""?(console.warn("wrong names"),!1):typeof e>"u"?(console.warn("wrong callback"),!1):(this.resolveNames(t).forEach(a=>{const r=this.resolveName(a);this.callbacks[r.namespace]instanceof Object||(this.callbacks[r.namespace]={}),this.callbacks[r.namespace][r.value]instanceof Array||(this.callbacks[r.namespace][r.value]=[]),this.callbacks[r.namespace][r.value].push(e)}),this)}off(t){return typeof t>"u"||t===""?(console.warn("wrong name"),!1):(this.resolveNames(t).forEach(s=>{const a=this.resolveName(s);if(a.namespace!=="base"&&a.value==="")delete this.callbacks[a.namespace];else if(a.namespace==="base")for(const r in this.callbacks)this.callbacks[r]instanceof Object&&this.callbacks[r][a.value]instanceof Array&&(delete this.callbacks[r][a.value],Object.keys(this.callbacks[r]).length===0&&delete this.callbacks[r]);else this.callbacks[a.namespace]instanceof Object&&this.callbacks[a.namespace][a.value]instanceof Array&&(delete this.callbacks[a.namespace][a.value],Object.keys(this.callbacks[a.namespace]).length===0&&delete this.callbacks[a.namespace])}),this)}trigger(t,e){const s=this;if(typeof t>"u"||t==="")return console.warn("wrong name"),!1;let a=null;const r=e instanceof Array?e:[];this.resolveNames(t);const o=this.resolveNames(t),h=this.resolveName(o[0]);if(h.namespace==="base")for(const l in this.callbacks)this.callbacks[l]instanceof Object&&this.callbacks[l][h.value]instanceof Array&&this.callbacks[l][h.value].forEach(function(d){d.apply(s,r)});else if(this.callbacks[h.namespace]instanceof Object){if(h.value==="")return console.warn("wrong name"),this;this.callbacks[h.namespace][h.value].forEach(function(l){l.apply(s,r)})}return a}resolveNames(t){let e=[];return typeof t=="string"?e=t.replace(/[^a-zA-Z0-9 ,/.]/g,"").replace(/[,/]+/g," ").split(" "):Array.isArray(t)&&t.forEach(s=>{typeof s=="string"&&e.push(s.replace(/[^a-zA-Z0-9 ,/.]/g,"").replace(/[,/]+/g," "))}),e}resolveName(t){const e={original:t,value:"",namespace:"base"},s=t.split(".");return e.value=s[0],s.length>1&&s[1]!==""&&(e.namespace=s[1]),e}}class J extends f{constructor(e){super();i(this,"canvas");i(this,"eventOffset");i(this,"mouse");i(this,"mouseMoveHandler");this.canvas=e,this.eventOffset={x:0,y:0},this.mouse=new y,this.mouseMoveHandler=s=>{var u;let{top:a=0,left:r=0,width:o=0,height:h=0}=(u=this.canvas)==null?void 0:u.getBoundingClientRect(),l=s.clientX-r,d=s.clientY-a;this.mouse.x=l/o*2-1,this.mouse.y=-(d/h)*2+1,this.eventOffset.x=l,this.eventOffset.y=d,this.trigger("mousemove",null)},this.canvas&&window.addEventListener("mousemove",this.mouseMoveHandler,!1)}release(){window.removeEventListener("mousemove",this.mouseMoveHandler,!1)}}class K extends f{constructor(e,s){super();i(this,"sources");i(this,"items");i(this,"toLoad");i(this,"loaded");i(this,"loaders");this.sources=e;const a=new C;a.setDecoderPath("draco/"),this.items={},this.toLoad=this.sources.length,this.loaded=0,this.loaders={gltfLoader:new A(s),textureLoader:new x(s),cubeTextureLoader:new P(s),fontLoader:new O(s)},this.loaders.gltfLoader.setDRACOLoader(a),this.startLoading()}startLoading(){for(const e of this.sources)e.type==="GLTF"?this.loaders.gltfLoader.load(e.path,s=>{this.sourceLoaded(e,s)}):e.type==="TEXTURE"?this.loaders.textureLoader.load(e.path,s=>{this.sourceLoaded(e,s)}):e.type==="FONT"&&this.loaders.fontLoader.load(e.path,s=>{this.sourceLoaded(e,s)})}sourceLoaded(e,s){this.items[e.name]=s,this.loaded++,this.loaded===this.toLoad&&this.trigger("ready",null)}}class m{constructor(t){i(this,"sizes");i(this,"scene");i(this,"canvas");i(this,"camera");i(this,"_camera");i(this,"resources");i(this,"time");i(this,"mouse");i(this,"eventOffset");var e,s,a;this._instance=t,this.sizes=t.sizes,this.scene=t.scene,this.camera=t.camera,this._camera=((e=t.camera)==null?void 0:e.instance)||null,this.time=t.time,this.mouse=(s=t.mousemove)==null?void 0:s.mouse,this.eventOffset=(a=t.mousemove)==null?void 0:a.eventOffset,this.canvas=t._canvas,this.resources=t.resources}resize(){}update(){}dispose(){}}class V extends m{constructor(e,s){super(s);i(this,"loadingManager");this.createLoading(),this.loadingManager=new E(()=>{console.log("Loaded"),this.endLoading()},(a,r,o)=>{console.log("Progress"),this.endLoadingBar(r,o)},()=>{console.log("error")})}endLoadingBar(e,s){const a=document.querySelector(".loading-bar"),r=e/s;a.style.transform=`scaleX(${r})`}endLoading(){const e=document.querySelector(".loading-bar"),s=document.querySelector(".loading-page");s&&(w.set(s.style,{opacity:1}),w.to(s.style,{duration:5,opacity:0,ease:"power1.inOut"}),window.setTimeout(()=>{e.style.transform="scaleX(0)",e.style.transformOrigin="100% 0",e.style.transition="transform 1.5s ease-in-out"},500))}createLoading(){if(document.querySelector(".loading-page"))return;const s=document.createElement("div");s.className="loading-page",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100vh",s.style.backgroundColor="rgba(0, 0, 0, 0.7)",s.style.pointerEvents="none",document.body.appendChild(s);const a=document.createElement("div");a.className="loading-bar",s.appendChild(a),a.style.position="absolute",a.style.top="50%",a.style.width="100%",a.style.height="2px",a.style.background="#ffffff",a.style.transform="scaleX(0)",a.style.transformOrigin="top left",a.style.transition="transform  0.5s"}resize(){}update(){}dispose(){}}class Q extends f{constructor(e){super();i(this,"width");i(this,"height");i(this,"pixelRatio");i(this,"resizeHandler");this.width=100,this.height=100,this.pixelRatio=Math.min(window.devicePixelRatio,2),this.resizeHandler=()=>{if(e.type==="parent"){const s=document.getElementById(e.id);if(s){const a=s.parentElement;a?(this.width=a.clientWidth,this.height=a.clientHeight):console.error("tips: The parent document cannot be found. Please put the current component inside the parent document ID according to the configuration item.")}else this.release(),console.error("tips: Could not find parent element ID, please check the configuration")}else this.width=window.innerWidth,this.height=window.innerHeight;this.trigger("resize",null)},this.resizeHandler(),window.addEventListener("resize",this.resizeHandler)}info(e="Now size"){console.log(e,"width:",this.width,"height:",this.height)}release(){window.removeEventListener("resize",this.resizeHandler)}}class ee extends m{constructor(e,s){var a,r;super(s);i(this,"cameraConfig");i(this,"controls");i(this,"instance");this.cameraConfig=e,this.instance=new M(this.cameraConfig.fov,((a=this.sizes)==null?void 0:a.width)/((r=this.sizes)==null?void 0:r.height),this.cameraConfig.near,this.cameraConfig.far),this.controls=new T(this.instance,this.canvas),this.setInstance(),this.setControls()}setInstance(){this.instance.position.set(this.cameraConfig.position.x,this.cameraConfig.position.y,this.cameraConfig.position.z),this.cameraConfig.lookAt&&this.instance.lookAt(this.scene.position),this.instance.updateProjectionMatrix(),this.scene.add(this.instance)}setControls(){const e=this.cameraConfig.controls;this.controls.enableDamping=e.enableDamping,this.controls.minPolarAngle=e.minPolarAngle,this.controls.maxPolarAngle=e.maxPolarAngle,this.controls.minAzimuthAngle=e.minAzimuthAngle,this.controls.maxAzimuthAngle=e.maxAzimuthAngle,this.controls.enablePan=e.enablePan}resize(){var e,s;this.instance.aspect=((e=this.sizes)==null?void 0:e.width)/((s=this.sizes)==null?void 0:s.height),this.instance.updateProjectionMatrix()}update(){var e;(e=this.controls)==null||e.update()}dispose(){var e;(e=this.controls)==null||e.dispose()}}class se extends m{constructor(e,s){super(s);i(this,"instance");this.instance=new R({canvas:this.canvas,antialias:e.antialias,alpha:e.alpha}),this.setRenderer(e)}setRenderer(e){this.instance.outputColorSpace=N,e.clearAlpha?this.instance.setClearAlpha(e.clearAlpha):this.instance.setClearAlpha(0),e.clearColor&&this.instance.setClearColor(e.clearColor),this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}info(e="present memory:"){console.log(e,this.instance.info.memory)}resize(){var e;this.instance.setSize((e=this.sizes)==null?void 0:e.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}update(){var e;this.instance.render(this.scene,(e=this.camera)==null?void 0:e.instance)}dispose(){this.instance.clear(),this.instance.setSize(0,0),this.instance.dispose(),this.info("cleared memory:")}}class te extends m{constructor(e,s){super(s);i(this,"renderer");i(this,"bloomLayer");i(this,"materials");i(this,"darkMaterial");i(this,"bloomComposer");i(this,"finalComposer");i(this,"darkenNonBloomed",e=>{e.isMesh&&this.bloomLayer.test(e.layers)===!1&&(this.materials[e.uuid]=e.material,e.material=this.darkMaterial)});i(this,"restoreMaterial",e=>{this.materials[e.uuid]&&(e.material=this.materials[e.uuid],delete this.materials[e.uuid])});this.renderer=s.renderer.instance,this.bloomLayer=new B,this.materials={},this.darkMaterial=new S({color:"black"}),this.bloomComposer=new g(this.renderer),this.finalComposer=new g(this.renderer),this.setBloomPass(e)}setBloomPass(e){this.bloomLayer.set(1);const a=new H(this.scene,this._camera);this.bloomComposer.renderToScreen=!1,this.bloomComposer.addPass(a),this.finalComposer.addPass(a);const r=new I(new y(this.renderer.domElement.offsetWidth,this.renderer.domElement.offsetHeight),e.strength,e.radius,e.threshold);this.bloomComposer.addPass(r)}update(){this.scene.traverse(this.darkenNonBloomed),this.bloomComposer.render(),this.scene.traverse(this.restoreMaterial),this.finalComposer.render()}}class ae extends m{constructor(e,s){super(s);i(this,"light");this.light=new b,this.light.name="light-group",this.setLight(e)}setLight(e){if(Array.isArray(e)&&!e.length)return console.error("please add light configuration");let s,a;e.forEach(({color:r,groundColor:o,type:h,intensity:l,distance:d,angle:u,penumbra:v,position:c,decay:k,helper:p})=>{switch(h){case"point":s=new W(r,l,d),p&&(a=new X(s,.5));break;case"ambient":s=new q(r,l);break;case"hemisphere":s=new _(r,o,l),p&&(a=new F(s,.5));break;case"spot":s=new D(r,l,d,u,v,k),p&&(a=new G(s,.5));break}s.position.set(c==null?void 0:c.x,c==null?void 0:c.y,c==null?void 0:c.z),s.isSpotLight&&this.light.add(s.target),s&&this.light.add(s),a&&this.light.add(a)}),this.scene.add(this.light)}}class ie extends f{constructor(){super();i(this,"clock");i(this,"start");i(this,"current");i(this,"elapsed");i(this,"delta");i(this,"timer");i(this,"index");i(this,"elapsedTime");i(this,"animationTick");this.clock=new U,this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,this.timer=0,this.index=0,this.elapsedTime=0,this.animationTick=null,this.tick()}tick(){const e=Date.now();this.delta=e-this.current,this.current=e,this.elapsed=e-this.start,this.elapsedTime=this.clock.getElapsedTime(),this.trigger("tick",null),window.requestAnimationFrame(()=>{this.tick()})}release(){this.animationTick&&window.cancelAnimationFrame(this.animationTick)}tickS(e=1e3,s){this.timer+=this.delta,this.timer>=e&&(this.index++,this.timer=0,s(this.index))}}class re extends m{constructor(e){super(e);i(this,"raycaster");this.raycaster=new Y}update(){this.raycaster.setFromCamera(this.mouse,this._camera)}}class ne{constructor(t,e=Z){i(this,"_canvas");i(this,"scene");i(this,"mousemove");i(this,"resources");i(this,"sizes");i(this,"camera");i(this,"renderer");i(this,"_config");i(this,"light");i(this,"time");i(this,"raycaster");i(this,"loading");i(this,"bloomPass");const s=document.getElementById(e.id);if(!s&&!t)throw new Error("canvas has already been initialized.");switch(this._canvas=t||s,this._config=e,this.mousemove=new J(this._canvas),this.sizes=new Q(this._config.size),this.scene=new j,this.time=new ie,this.camera=new ee(this._config.camera,this),this.light=new ae(this._config.light,this),this.raycaster=new re(this),this.renderer=new se(this._config.renderer,this),this._config.rendererPass.type){case"OUTLINE":break;case"BLOOM":this.bloomPass=new te(this._config.rendererPass.bloomConfig,this);break}this.loading=new V(1,this),this.resources=new K(this._config.sources,this.loading.loadingManager),this.sizes.on("resize",()=>{this.resize()}),this.time.on("tick",()=>{this.update()})}setOption(t){this._config={...this._config,...t}}resize(){var t,e;(t=this.camera)==null||t.resize(),(e=this.renderer)==null||e.resize()}update(){var t,e,s,a;switch((t=this.camera)==null||t.update(),this.raycaster.update(),this._config.rendererPass.type){case"OUTLINE":break;case"BLOOM":(e=this.bloomPass)==null||e.update();break;case"NONE":(s=this.renderer)==null||s.update();break;default:(a=this.renderer)==null||a.update();break}}clearGroup(t){if(!t.children.length)return;const e=a=>{var r;(r=a.geometry)==null||r.dispose()},s=a=>{let r=a.children.filter(o=>o);r.forEach(o=>{o.children.length?s(o):(e(o),o.clear())}),a.clear(),r=null};s(t)}dispose(){this.sizes.off("resize"),this.sizes.release(),this.time.off("tick"),this.time.release(),this.mousemove.off("mousemove"),this.mousemove.release(),this.scene.traverse(t=>{var e;(e=t==null?void 0:t.geometry)==null||e.dispose(),(t instanceof b||t instanceof $)&&this.clearGroup(t)}),this.scene.clear(),this.renderer.dispose(),this.camera.dispose()}}i(ne,"__ins");export{Z as C,ne as T};
